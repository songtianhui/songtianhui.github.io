---
title: 数字图像处理课程笔记
categories:
  - 课程
  - Digital Image Processing
mathjax: true
date: 2021-09-08 01:33:49
tags:
---




# Ch1 概述

- 数字图像是指由被称作像素的小块区域组成的二维矩阵。
  - 将物理图像行列划分后，每个小块区域称为像素（pixel）。
  - 每个像素包括两个属性：位置和亮度 （或色彩）。

- 数字图像的两个基本问题
  - 像素数目
  - 灰度值的度量
  - 本质问题就是物理信号离散化，数字化

<!--more-->

## 图像获取

图像获取就是图像数字化的过程，包括扫描、**采样（成像技术）**和**量化（模数转化技术）**。

- 图像采样：用有限的样本数目去近似无限的现实物理信号（有限近似无限）。

- 图像量化，用离散计算机表示去近似连续的现实物理信号（离散近似连续）。
  - 取样点数和量化级数的选取
    - 条件：图像有 $M\times N$个像素，每个像素有 $Q$ 个灰度级别。
    - 取值规则：$M, N, Q$ 通常取 2 的整数次幂。若 $Q = 2^8 = 256$，称为 8bit 量化，或称256灰度级。
    - 取值范围：由于存在量化误差，原则上 b 越大重建图像失真越小。对于人眼应用 b 取 5-8；而对于卫星图片等图像分析应用b取8-12。
  - $M\times N$ 必须满足奈奎斯特取样定理，否则会因取样点数不够产生混淆失真。



- 最佳量化
  - 使量化误差最小的量化方法为最佳量化。
  - 使用均方误差测度讨论最佳量化。

设 $Z$ 和 $q$ 分别代表像素幅度和其量化值，$p(Z)$ 为像素幅度概率密度函数；$Z$ 的取值范围在 $H_1$ 和 $H_2$ 之间，量化总层数为 $K$，$\delta^2$ 表示量化器量化的均方误差，则
$$
\delta^2 = \sum\limits_{k=1}^{K} \int_{Z_k}^{Z_{k+1}} (Z - q_k)^2p(Z) dZ。
$$
当量化层数足够大，每个判决层的 $p(Z)$ 可以近似为均匀分布，则
$$
\begin{aligned}
\delta^{2} &=\sum_{k=1}^{K} \int_{Z_{k}}^{Z_{k+1}}\left(Z-q_{k}\right)^{2} p(Z) d Z \\
&=\sum_{k=1}^{K} p(Z) \int_{Z_{k}}^{Z_{k+1}}\left(Z-q_{k}\right)^{2} d Z \\
&=\frac{1}{3} \sum_{k=1}^{K} p(Z)\left[\left(Z_{k+1}-q_{k}\right)^{3}-\left(Z_{k}-q_{k}\right)^{3}\right]
\end{aligned}
$$
对 $q_k$ 求导并令等于 $0$：
$$
0=\int_{Z_{k}}^{Z_{k+1}} p(Z)\left(-2 Z+2 q_{k}\right) d Z
$$
于是
$$
q_{k}=\dfrac{\int_{Z_{k}}^{Z_{k+1}} Z p(Z) d Z}{\int_{Z_{k}}^{Z_{k+1}} p(Z) d Z}
$$
若 $p(Z)$ 为常数，则 $q_k = \frac{1}{2}(Z_k + Z_{k+1})$，此时量化误差为 $\dfrac{(H_2 - H_1)^2}{12K^2}$。



- 图像获取设备的主要应用
  - 基于图像采集卡或图像卡将模拟制式的视频信号采集到计算机。
  - 摄象机本身带有数字化部件可以直接将数字图像通过计算机端口（如并口、USB接口）或标准设备（如磁盘驱动器）传送进计算机。



## 图像显示

- 图像显示和打印的基本原理
  - 显示分辨率：每英寸荧光点或打印墨点的数目，单位是dpi。
  - 电视机平均分辨率0.76mm。SVGA显示器平均分辨率0.28mm。
  - 打印分辨率需要在300dpi—600dpi之上。
- 点阵位图格式
  - 用文件中的几个字节表示表示像素点的位置和颜色。
  - 图像分辨率：每英寸像素点的数目，单位ppi。
- 显示与文件的关系
  - 若图像分辨率比显示分辨率高，则显示出的图像比实际图像大。
  - 若图像分辨率比显示分辨率低，则显示出的图像比实际图像小。



## 图像表示

- 1位二值图像
- 8位灰度图像

  - 位平面。
    - 数字图像每一个像素点的灰度值均可以表示成二进制数，这样从二进制每一位的微观角度出发，能够将图片分解为若干个位平面。
    - 图像的重要信息主要包含在高位位平面中，从低位位平面的显示效果中不可识别原始图像信息。
  - 抖动技术（dithering）
    - 基本策略是平衡灰度分辨率到空间分辨率。基本原理是当人眼从较远距离观察图像时，将会平均局部小区域像素的灰度值，并记录之。
    - 很明显采用抖动矩阵无法完整的表达图像信息，甚至造成打印的图像失真。*解决方案：Floyd-Steinberg算法*。
- 24位彩色图像

  - RGB模式。(相加混色模型，用于发光物体)

  - CMYK模式。（相减混色模型，用于不发光物体）

    - 三次色（青色Cyan，洋红Magenta和黄色Yellow）K为真正黑色。

  - HSB模型。

    - 色相（Hue），饱和度（Saturation），亮度（Brightness）。
    - *在绘画艺术上，饱和度的概念可描述如下：是一种纯色加上白色染料后的结果，此时色彩的饱和度发生变化而色彩的亮度不发生变化。*
    - *同样在绘画艺术上，亮度的概念可描述如下：是一种纯色加上黑色染料后的结果，此时色彩的亮度发生变化而色彩的饱和度不发生变化。*
- 8位索引图像
  - 调色板（palette）：图像的色彩索引表。
  - 若图像的色彩数远小于全色彩数时，当每个像素的值用色彩索引表的位置表示就可以大大节约存储空间。



# Ch2 二值图像与像素关系

## 邻域关系

- 4邻域 $N_4(p)$
  - 邻域距离：$<=1$。就是上下左右4个点。
- 对角线邻域 $N_D(p)$
  - 四个对角。
- 8邻域 $N_8(4) = N_4(p) + N_D(p)$
  - 邻域距离：$<2$。就是周围一圈8个点。



## 连接关系

可以用来分离物体，鉴定边界。

在二值图上通过邻域进行定义：

- 4连接
  - $p \in N_4(q)$
- 8连接
  - $p \in N_8(q)$
- m连接
  - $p \in N_D(q) \wedge (N_4(P) \cap N_4(q) = \emptyset)$



## 邻接关系

- 有连接关系 $(4,8,m)$ 的像素 $p,q$ 是邻接关系。

- 两个子图像 $S_1, S_2$，如果存在 $S_1$ 中的某像素和 $S_2$ 中的某像素是邻接关系，则两子图是邻接关系。

- 从 $p $ 到 $q$ 的一条**路径**是值一个像素序列 $p_1, .., p_n$，$p_i$ 与 $p_{i+1}$ 邻接。
  - 像素 $p,q$ 之间存在一条路径，则称 $p,q$ **联通**。

- 图像 $S$ 中的任何一个像素 $p$，与 $p$ 联通的所有像素的集合构成一个**联通分量**，联通分量中所有像素两两联通。
  - 4连接：4联通分量
  - 8/m连接：2联通分量

- **对象分割**：标记联通分量。
  - 算法就是遍历扫描，没有邻接标记，有邻接标记为邻接标记并记录等价类。



## 距离

- 正定性：$D(p,q) \geq 0$，等号当且仅当 $p = q$。
- 对称性：$D(p,q) = D(q,p)$。
- 三角不等式：$D(p,q) \geq D(p,z) + D(q,z)$。

常见距离：

- Minkowski 距离
  - $D(\boldsymbol{p}, \boldsymbol{q})=\left(\sum_{i=1}^{n}\left|p_{i}-q_{i}\right|^{k}\right)^{\frac{1}{k}}$



## 骨架抽取

- 计算距离图像：
  - 初始化距离为无穷大。
  - 边缘点：8邻域有背景点，距离为0。
  - 非边缘点，距离为8邻域中最小距离+1。
  - 反复扫描图像，重复上述步骤。

- 计算骨架图像：
  - 最大值在骨架上。
  - 以最小梯度扩展。



# Ch3 灰度直方图与点运算

## 灰度直方图 Histogram

定义：灰度级的函数，描述的是图像中每种灰度级像素的个数，反映图像中每种灰度出现的频率。横坐标是灰度级，纵坐标是灰度级出现的频率。

$\mathrm{H}(\mathrm{D})=\lim\limits_{\Delta \mathrm{D} \rightarrow 0} \dfrac{\mathrm{A}(\mathrm{D})-\mathrm{A}(\mathrm{D}+\Delta \mathrm{D})}{\mathrm{D}-(\mathrm{D}+\Delta \mathrm{D})}=\lim\limits_{\Delta \mathrm{D} \rightarrow 0} \dfrac{\mathrm{A}(\mathrm{D})-\mathrm{A}(\mathrm{D}+\Delta \mathrm{D})}{-\Delta \mathrm{D}}=-\dfrac{\mathrm{d}}{\mathrm{dD}} \mathrm{A}(\mathrm{D})$

其中 $A(D)$ 为阈值面积函数：为一幅连续图像中被具有灰度级 $D$ 的所有轮廓线所包围的面积。

对于离散函数，固定 $\Delta D$ 为 $1$，则 $H(D) = A(D+1) - A(D)$。

*高维色彩直方图*。

## 性质与计算

- 不表示图像的空间信息。
- 任一特定图像都有唯一直方图，但反之并不成立。

- 若一幅图像包含一个灰度均匀一致，且背景与物体对比度很强，假设物体的边界由灰度级 $D_1$ 定义的轮廓线，则
  - $\int_{D_{1}}^{\infty} H(D) d D = \text{物体的面积}$

- 直方图的可加性：一副图像由若干个不相交的区域构成，则整幅图像的直方图是这若干个区域直方图之和。

## 用途

- 数字化参数
  - 一般一幅数字图像应该利用全部或几乎全部可能的灰度级。
  - 对直方图做快速检查。
- 边界阈值选择
  - 使用轮廓线确定简单物体边界的方法，称为**阈值化**。
  - 对物体与背景有较强对比的景物的分割特别有用。
  - 双峰直方图。
- 摄影中的常见名词
  - 过曝（Overexposed）
  - 正常曝光（Average）
  - 曝光不足（Underexposed）
- 图像增强
  - 图像增强技术不需要考虑图像降质的原因，只将图像中感兴趣的特征有选择地突出，将不需要的特征进行衰减。
  - 图像增强没有一个的统一理论，如何评价图像增强的结果好坏也没有统一的标准。
  - 目的是改善图像视觉效果，便于观察和分析；便于人工或机器对图像的进一步处理。
  - 有空间域法：点处理（图象灰度变换、直方图均衡、伪彩色处理等）；*频率域法：高、低通滤波、同态滤波等。*
    - **空间域**图像增强技术指在空间域中，通过线性或非线性变换来增强构成图像的像素。
    - 点处理：作用于单个像素的空间域处理方法，包括图像灰度变换、直方图处理、伪彩色处理等技术。
    - 模板 处理：作用于像素邻域的处理方法，包括空域平滑、空域锐化等技术。

## 点运算 Point Operation

定义：对于一幅输入图像，将产生一幅输出图像，输出图像的每个像素点的灰度值由输入像素点决定。

- 点运算由灰度变换函数（gray-scale transformation, GST）确定。

- 令 $r$ 和 $s$ 所定义的变量分别是 $f(x, y)$ 和 $g(x,y)$ 在任意点 $(x,y)$ 的灰度级，则 $T$ 为灰度变换函数
  - $s = T(r)$
  - 与局部（邻域）运算的区别：输入像素\-输出像素一一对应。
  - 与几何运算的差别，不改变图像的空间关系。
- 运用
  - 光度学标定（photometric calibration），希望数字图像的灰度能够真实反映图像的物理特性。
  - 对比度增强（contrast enhancement）或对比度扩展（contrast stretching）。
  - 显示标定（display calibration）
    - 显示设备不能线性地将灰度值转换为光强度，因此点运算和显示非线性组合可以保持显示图像时的线性关系。
- 点运算种类 $0 \leq r \leq 1$，$0$ 黑 $1$ 白
  - 线性点运算 $s = a \times r + b$。
  - 非线性点运算。
  - 图像反转 $s = L - r - 1$。
    - 反转变换适用于增强嵌入于图像暗色区域的白色或灰色细节, 特别是当黑色面积占主导地位时。
  - 对数变换 $s = c \log{(1 + r)}$
    - 对数变换使一窄带低灰度输入图像值映射为一宽带输出值，这种变换可以用来扩展被压缩的高值图像中的暗像素。
  - 幂次变换 $s = c r^{\gamma}$

