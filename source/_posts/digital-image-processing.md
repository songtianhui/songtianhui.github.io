---
title: 数字图像处理课程笔记
categories:
  - 课程
  - Digital Image Processing
mathjax: true
date: 2021-09-08 01:33:49
tags:
typora-root-url: digital-image-processing
---



---


# Ch1 概述

- 数字图像是指由被称作像素的小块区域组成的二维矩阵。
  - 将物理图像行列划分后，每个小块区域称为像素（pixel）。
  - 每个像素包括两个属性：位置和亮度 （或色彩）。

- 数字图像的两个基本问题
  - 像素数目
  - 灰度值的度量
  - 本质问题就是物理信号离散化，数字化

<!--more-->

## 图像获取

图像获取就是图像数字化的过程，包括扫描、**采样（成像技术）**和**量化（模数转化技术）**。

- 图像采样：用有限的样本数目去近似无限的现实物理信号（有限近似无限）。

- 图像量化，用离散计算机表示去近似连续的现实物理信号（离散近似连续）。
  - 取样点数和量化级数的选取
    - 条件：图像有 $M\times N$个像素，每个像素有 $Q$ 个灰度级别。
    - 取值规则：$M, N, Q$ 通常取 2 的整数次幂。若 $Q = 2^8 = 256$，称为 8bit 量化，或称256灰度级。
    - 取值范围：由于存在量化误差，原则上 b 越大重建图像失真越小。对于人眼应用 b 取 5-8；而对于卫星图片等图像分析应用b取8-12。
  - $M\times N$ 必须满足奈奎斯特取样定理，否则会因取样点数不够产生混淆失真。



- 最佳量化
  - 使量化误差最小的量化方法为最佳量化。
  - 使用均方误差测度讨论最佳量化。

设 $Z$ 和 $q$ 分别代表像素幅度和其量化值，$p(Z)$ 为像素幅度概率密度函数；$Z$ 的取值范围在 $H_1$ 和 $H_2$ 之间，量化总层数为 $K$，$\delta^2$ 表示量化器量化的均方误差，则
$$
\delta^2 = \sum\limits_{k=1}^{K} \int_{Z_k}^{Z_{k+1}} (Z - q_k)^2p(Z) dZ。
$$
当量化层数足够大，每个判决层的 $p(Z)$ 可以近似为均匀分布，则
$$
\begin{aligned}
\delta^{2} &=\sum_{k=1}^{K} \int_{Z_{k}}^{Z_{k+1}}\left(Z-q_{k}\right)^{2} p(Z) d Z \\
&=\sum_{k=1}^{K} p(Z) \int_{Z_{k}}^{Z_{k+1}}\left(Z-q_{k}\right)^{2} d Z \\
&=\frac{1}{3} \sum_{k=1}^{K} p(Z)\left[\left(Z_{k+1}-q_{k}\right)^{3}-\left(Z_{k}-q_{k}\right)^{3}\right]
\end{aligned}
$$
对 $q_k$ 求导并令等于 $0$：
$$
0=\int_{Z_{k}}^{Z_{k+1}} p(Z)\left(-2 Z+2 q_{k}\right) d Z
$$
于是
$$
q_{k}=\dfrac{\int_{Z_{k}}^{Z_{k+1}} Z p(Z) d Z}{\int_{Z_{k}}^{Z_{k+1}} p(Z) d Z}
$$
若 $p(Z)$ 为常数，则 $q_k = \frac{1}{2}(Z_k + Z_{k+1})$，此时量化误差为 $\dfrac{(H_2 - H_1)^2}{12K^2}$。



- 图像获取设备的主要应用
  - 基于图像采集卡或图像卡将模拟制式的视频信号采集到计算机。
  - 摄象机本身带有数字化部件可以直接将数字图像通过计算机端口（如并口、USB接口）或标准设备（如磁盘驱动器）传送进计算机。



## 图像显示

- 图像显示和打印的基本原理
  - 显示分辨率：每英寸荧光点或打印墨点的数目，单位是dpi。
  - 电视机平均分辨率0.76mm。SVGA显示器平均分辨率0.28mm。
  - 打印分辨率需要在300dpi—600dpi之上。
- 点阵位图格式
  - 用文件中的几个字节表示表示像素点的位置和颜色。
  - 图像分辨率：每英寸像素点的数目，单位ppi。
- 显示与文件的关系
  - 若图像分辨率比显示分辨率高，则显示出的图像比实际图像大。
  - 若图像分辨率比显示分辨率低，则显示出的图像比实际图像小。



## 图像表示

- 1位二值图像
- 8位灰度图像

  - 位平面。
    - 数字图像每一个像素点的灰度值均可以表示成二进制数，这样从二进制每一位的微观角度出发，能够将图片分解为若干个位平面。
    - 图像的重要信息主要包含在高位位平面中，从低位位平面的显示效果中不可识别原始图像信息。
  - 抖动技术（dithering）
    - 基本策略是平衡灰度分辨率到空间分辨率。基本原理是当人眼从较远距离观察图像时，将会平均局部小区域像素的灰度值，并记录之。
    - 很明显采用抖动矩阵无法完整的表达图像信息，甚至造成打印的图像失真。*解决方案：Floyd-Steinberg算法*。
- 24位彩色图像

  - RGB模式。(相加混色模型，用于发光物体)

  - CMYK模式。（相减混色模型，用于不发光物体）

    - 三次色（青色Cyan，洋红Magenta和黄色Yellow）K为真正黑色。

  - HSB模型。

    - 色相（Hue），饱和度（Saturation），亮度（Brightness）。
    - *在绘画艺术上，饱和度的概念可描述如下：是一种纯色加上白色染料后的结果，此时色彩的饱和度发生变化而色彩的亮度不发生变化。*
    - *同样在绘画艺术上，亮度的概念可描述如下：是一种纯色加上黑色染料后的结果，此时色彩的亮度发生变化而色彩的饱和度不发生变化。*
- 8位索引图像
  - 调色板（palette）：图像的色彩索引表。
  - 若图像的色彩数远小于全色彩数时，当每个像素的值用色彩索引表的位置表示就可以大大节约存储空间。



---

# Ch2 二值图像与像素关系

## 邻域关系

- 4邻域 $N_4(p)$
  - 邻域距离：$<=1$。就是上下左右4个点。
- 对角线邻域 $N_D(p)$
  - 四个对角。
- 8邻域 $N_8(4) = N_4(p) + N_D(p)$
  - 邻域距离：$<2$。就是周围一圈8个点。



## 连接关系

可以用来分离物体，鉴定边界。

在二值图上通过邻域进行定义：

- 4连接
  - $p \in N_4(q)$
- 8连接
  - $p \in N_8(q)$
- m连接
  - $p \in N_D(q) \wedge (N_4(P) \cap N_4(q) = \emptyset)$



## 邻接关系

- 有连接关系 $(4,8,m)$ 的像素 $p,q$ 是邻接关系。

- 两个子图像 $S_1, S_2$，如果存在 $S_1$ 中的某像素和 $S_2$ 中的某像素是邻接关系，则两子图是邻接关系。

- 从 $p $ 到 $q$ 的一条**路径**是值一个像素序列 $p_1, .., p_n$，$p_i$ 与 $p_{i+1}$ 邻接。
  - 像素 $p,q$ 之间存在一条路径，则称 $p,q$ **联通**。

- 图像 $S$ 中的任何一个像素 $p$，与 $p$ 联通的所有像素的集合构成一个**联通分量**，联通分量中所有像素两两联通。
  - 4连接：4联通分量
  - 8/m连接：2联通分量

- **对象分割**：标记联通分量。
  - 算法就是遍历扫描，没有邻接标记，有邻接标记为邻接标记并记录等价类。



## 距离

- 正定性：$D(p,q) \geq 0$，等号当且仅当 $p = q$。
- 对称性：$D(p,q) = D(q,p)$。
- 三角不等式：$D(p,q) \geq D(p,z) + D(q,z)$。

常见距离：

- Minkowski 距离
  - $D(\boldsymbol{p}, \boldsymbol{q})=\left(\sum_{i=1}^{n}\left|p_{i}-q_{i}\right|^{k}\right)^{\frac{1}{k}}$



## 骨架抽取

- 计算距离图像：
  - 初始化距离为无穷大。
  - 边缘点：8邻域有背景点，距离为0。
  - 非边缘点，距离为8邻域中最小距离+1。
  - 反复扫描图像，重复上述步骤。

- 计算骨架图像：
  - 最大值在骨架上。
  - 以最小梯度扩展。



---

# Ch3 灰度直方图与点运算

## 灰度直方图 Histogram

定义：灰度级的函数，描述的是图像中每种灰度级像素的个数，反映图像中每种灰度出现的频率。横坐标是灰度级，纵坐标是灰度级出现的频率。

$\mathrm{H}(\mathrm{D})=\lim\limits_{\Delta \mathrm{D} \rightarrow 0} \dfrac{\mathrm{A}(\mathrm{D})-\mathrm{A}(\mathrm{D}+\Delta \mathrm{D})}{\mathrm{D}-(\mathrm{D}+\Delta \mathrm{D})}=\lim\limits_{\Delta \mathrm{D} \rightarrow 0} \dfrac{\mathrm{A}(\mathrm{D})-\mathrm{A}(\mathrm{D}+\Delta \mathrm{D})}{-\Delta \mathrm{D}}=-\dfrac{\mathrm{d}}{\mathrm{dD}} \mathrm{A}(\mathrm{D})$

其中 $A(D)$ 为阈值面积函数：为一幅连续图像中被具有灰度级 $D$ 的所有轮廓线所包围的面积。

对于离散函数，固定 $\Delta D$ 为 $1$，则 $H(D) = A(D+1) - A(D)$。

*高维色彩直方图*。

## 性质与计算

- 不表示图像的空间信息。
- 任一特定图像都有唯一直方图，但反之并不成立。

- 若一幅图像包含一个灰度均匀一致，且背景与物体对比度很强，假设物体的边界由灰度级 $D_1$ 定义的轮廓线，则
  - $\int_{D_{1}}^{\infty} H(D) d D = \text{物体的面积}$

- 直方图的可加性：一副图像由若干个不相交的区域构成，则整幅图像的直方图是这若干个区域直方图之和。

## 用途

- 数字化参数
  - 一般一幅数字图像应该利用全部或几乎全部可能的灰度级。
  - 对直方图做快速检查。
- 边界阈值选择
  - 使用轮廓线确定简单物体边界的方法，称为**阈值化**。
  - 对物体与背景有较强对比的景物的分割特别有用。
  - 双峰直方图。
- 摄影中的常见名词
  - 过曝（Overexposed）
  - 正常曝光（Average）
  - 曝光不足（Underexposed）
- 图像增强
  - 图像增强技术不需要考虑图像降质的原因，只将图像中感兴趣的特征有选择地突出，将不需要的特征进行衰减。
  - 图像增强没有一个的统一理论，如何评价图像增强的结果好坏也没有统一的标准。
  - 目的是改善图像视觉效果，便于观察和分析；便于人工或机器对图像的进一步处理。
  - 有空间域法：点处理（图象灰度变换、直方图均衡、伪彩色处理等）；*频率域法：高、低通滤波、同态滤波等。*
    - **空间域**图像增强技术指在空间域中，通过线性或非线性变换来增强构成图像的像素。
    - 点处理：作用于单个像素的空间域处理方法，包括图像灰度变换、直方图处理、伪彩色处理等技术。
    - 模板 处理：作用于像素邻域的处理方法，包括空域平滑、空域锐化等技术。

## 点运算 Point Operation

定义：对于一幅输入图像，将产生一幅输出图像，输出图像的每个像素点的灰度值由输入像素点决定。

- 点运算由灰度变换函数（gray-scale transformation, GST）确定。

- 令 $r$ 和 $s$ 所定义的变量分别是 $f(x, y)$ 和 $g(x,y)$ 在任意点 $(x,y)$ 的灰度级，则 $T$ 为灰度变换函数
  - $s = T(r)$
  - 与局部（邻域）运算的区别：输入像素\-输出像素一一对应。
  - 与几何运算的差别，不改变图像的空间关系。
- 运用
  - 光度学标定（photometric calibration），希望数字图像的灰度能够真实反映图像的物理特性。
  - 对比度增强（contrast enhancement）或对比度扩展（contrast stretching）。
  - 显示标定（display calibration）
    - 显示设备不能线性地将灰度值转换为光强度，因此点运算和显示非线性组合可以保持显示图像时的线性关系。
- 点运算种类 $0 \leq r \leq 1$，$0$ 黑 $1$ 白
  - 线性点运算 $s = a \times r + b$。
  - 非线性点运算。
  - 图像反转 $s = L - r - 1$。
    - 反转变换适用于增强嵌入于图像暗色区域的白色或灰色细节, 特别是当黑色面积占主导地位时。
  - 对数变换 $s = c \log{(1 + r)}$
    - 对数变换使一窄带低灰度输入图像值映射为一宽带输出值，这种变换可以用来扩展被压缩的高值图像中的暗像素。
  - 幂次变换 $s = c r^{\gamma}$
    - 当 $\gamma < 1$ 时，把输入的窄带暗值映射到宽带输出值，提高灰度级，在正比例函数上方，使图像变亮。
    - 当 $\gamma > 1$ 时，把输入的窄带亮值映射到宽带输出值，降低灰度级，在正比例函数下方，使图像变暗。
  - 分段线性变换
    - 形式可任意合成，有些重要变换的实际应用可由分段线性函数描述。
    - 主要缺点：需要更多的用户输入。
    - 对比度拉伸，扩展图像处理时灰度系的动态范围。
    - 灰度切割，提高特定灰度范围的亮度。
    - 位平面。



## 直方图处理

对于一幅给定的图像来说，每一个像素取得 $[0, 1]$区间内的灰度级是随机的，也就是说 $r$ 是一个随机变量。

假定它们是连续的随机变量，那么就可以用概率密度函数 $p(r)$ 来表示原始图像的灰度分布。

计算机里只能离散化了：用 $r_k$ 代表灰度级则 $P_r(r_k) = \frac{n_k}{n}, 0 \leq r_k \leq 1$。

### 直方图均衡化

变换函数 $s = T(r)$ 应满足下列条件：

- 单调性，在 $0 \leq r \leq 1$ 的区间内，$T(r) $ 的值单调增加。
- 有界性，对于 $0 \leq r \leq 1$，有 $0 \leq T(r) \leq 1$。

从 $s$ 到 $r$ 的反变换：$r = T^{-1}(s)$。

一幅图像的灰度级可以被视为区间 $[0,1]$ 的随机变量，就可以用概率密度函数（PDF）来描述。

令 $p_{r}(r)$ 和 $p_{s}(s)$ 分别代表随机变量 $r$ 和 $s$ 的概率密度函数。由概 率论可知：如果 $p_{r}(r)$ 和 $T^{-1}(s)$ 已知，则变换变量 $s$ 的概率密度函数 $p_{s}(s)$ 可由下式得到:
$$
p_{s}(s)=p_{r}(r)\left|\frac{d T^{-1}(s)}{d s}\right|=p_{r}(r)\left|\frac{d r}{d s}\right|
$$


直方图均衡化处理是以累积分布函数变换法为基础的直方图修正法。假定变换函数为：
$$
s=T(r)=\int_{0}^{r} p_{r}(\omega) d \omega
$$
对 $r$ 进行求导带入得：
$$
\begin{aligned}
p_{s}(s) &=\left[p_{r}(r) \cdot \frac{d r}{d s}\right]_{r=T^{-1}(s)} \\ &=\left[p_{r}(r) \cdot \frac{1}{d s / d r}\right]_{r=T^{-1}(s)} \\
&=\left[p_{r}(r) \cdot \frac{1}{p_{r}(r)}\right]=1
\end{aligned}
$$

- 由上面的推导可见，在变换后的变量 $s$ 在定义域内的概率密度是均匀分布。

- 用 $r$ 的累积分布函数作为变换函数，可产生一幅灰度级分布具有均匀概率密度的图像，其结果扩展了像素取值的动态范围。

- 这都是基于连续随机变量，离散化时用频数近似代替频率，积分换成求和。

- 因此这种方法对于对比度较弱的图像进行处理是很有效的。



### 直方图的规定化

使处理的图像具有指定的直方图形状。

假设 $z$ 表示变化后的连续灰度级，$p_r(r)$表示输入图像的概率密度函数，$p_z(z)$表示输出图像的概率密度函数。

$T(r)=\int_{0}^{r} p_{r}(u) d u, G(z)=\int_{0}^{z} p_{z}(w) d w$，所以 $z= G^{-1}(T(r))$。



### 空间域滤波增强

卷积（



---

# Ch4 图像复原与锐化

## 概述

**图像复原**与**图像增强**的目的都是对图像进行改进，改善图像的视觉效果，但两者使用的方法和评价标准不同。

- 图像增强：旨在改善图像质量。
  - 不考虑图像降质的原因，只将图像中感兴趣的特征有选择地突出（增强），而衰减其不需要的特征。
  - 改善后的图像不一定要去逼近原图像。
  - 主观过程。
  - 提高图像的可懂度。
  - 空间域法和频率域法。
- 图象复原：力求保持图像的本来面目，以保真原则为前提找出图像降质的原因，描述其物理过程，提出数学模型。
  - 要考虑图像降质的原因，建立“降质模型“。
  - 要建立评价复原好坏的客观标准。
  - 客观过程。
  - 提高图像的逼真度。
  - 重点介绍线性复原方法。

## 图像退化

图像在形成、记录、处理和传输过程中，由于成像系统、记录设备、传输介质和处理方法的不完善，会导致图像质量下降。这一过程称为**图像的退化**。退化的形式有模糊、失真、有噪声等。

图像的复原就是要尽可能恢复退化图像的本来面目，它是沿图像降质的逆向过程进行。

- 退化过程可以被模型化为一个退化函数和一个加性噪声项，处理一幅输入图像 $f(x,y)$ 产生一幅退化图像 $g(x,y)$。
- 给定 $g(x,y)$ 和关于退化函数 $H$ 的一些知识以及外加噪声项 $\eta(x,y)$，图像复原的目的是获得关于原始图像的近似估计 $\hat{f}(x,y)$。

![](Screenshot from 2021-09-19 15-49-08.png)

如果系统 $H$ 是一个线性，位置不变性的过程，那么在空间域中给出的退化图像由下式给出：
$$
g(x,y) = h(x,y)\cdot f(x,y) + \eta(x,y)
$$

## 噪声模型

- 在实际应用中，往往假设噪声是白噪声，即它的频谱密度为常数，且与图像不相关。
- 数字图像的噪声主要来源于图像的获取和传输过程。图像传输器的工作情况受各种因素的影响，如图像获取中的环境条件和传感器件自身的质量。
- 高斯噪声
  - $p(z)=\dfrac{1}{\sqrt{2 \pi} \sigma} e^{-(z-\mu)^{2} / \sigma^{2}}$
  - 高斯噪声的产生源于电子电路噪声和由低照明度或高温带来的传感器噪声。
- 瑞利噪声
  - $p(z)= \begin{cases}\dfrac{2}{b}(z-2) e^{-(z-\mu)^{2} / 2 \sigma^{2}}, & z \geq a \\ 0, & z<a\end{cases}$
- 伽马噪声
  - $p(z)= \begin{cases}\dfrac{a^{b} z^{b-1}}{(b-1) !} e^{-a z}, & z \geq 0 \\ 0, & z<0\end{cases}$
  - 伽马噪声可应用于激光成像中。

- 指数噪声
- 均匀噪声
- 脉冲噪声（椒盐噪声）
  - 双极脉冲噪声也叫椒盐噪声。
  - 双极脉冲噪声也叫椒盐噪声，在图像上表现为孤立的亮点或暗点。
- 周期噪声
  - 唯一一种空间依赖型噪声。
  - 可以通过频率域滤波显著减少。

## 空间滤波复原

当仅有加性噪声存在时，可以选择空间滤波方法。事实上，在这一特殊情况下，图像的增强和复原几乎是不可区别的。

- 算数均值滤波器
- 几何均值滤波器
  - 几何均值滤波器达到的平滑度可以与算术均值滤波器相比，但在滤波过程中丢失更少的图像细节。
- 谐波均值滤波器
  - 谐波均值滤波器对于“盐” 噪声效果较好，但不适于“胡椒”噪声。它善于处理高斯噪声。
- 逆谐波均值滤波器
  - $\hat{f}(x, y)=\dfrac{\sum_{(s, t) \in S_{x y}} g(s, t)^{Q+1}}{\sum_{(s, t) \in S_{x y}} g(s, t)^{Q}}$，其中 $Q$ 称为滤波器的阶数。
  - 当 $Q$ 值为正数时，滤波器用于消除“胡椒”噪声；当 $Q$ 值为负数时，滤波器用于消除“盐”噪声。

